<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Tratamiento - Clear Water</title>
    <link rel="icon" href="../imgs/logo/ClearWaterPiscinasLogoOriginal.png" type="image/png">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="../home.css">
    <link rel="stylesheet" href="styles.css">
    
    <style>
        .box-productos {
            background-color: var(--trescolor);
            color: #ffffff;
            border-radius: 0.8rem;
            padding: 1.5rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        .box-productos ul li {
            border-bottom: 1px solid rgba(255,255,255,0.2);
            padding: 0.5rem 0;
        }
        .box-productos ul li:last-child {
            border-bottom: none;
        }
        .box-productos i {
            color: #ffffff; /* Iconos blancos */
        }
    </style>
</head>

<body>

<header>
<nav class="navbar navbar-expand-lg fixed-top header-clearwater">
  <div class="container-fluid">
    <a class="navbar-brand" href="../index.html">
      <img src="../imgs/logo/ClearWater Piscinas Logo.svg" alt="Clear Water" class="logo-clearwater">
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavDropdown">
      <ul class="navbar-nav ms-auto me-3">
        <li class="nav-item"><a class="nav-link link-navbar-clear" href="../index.html">Home</a></li>
        <li class="nav-item"><a class="nav-link link-navbar-clear" href="../servicios/index.html">Servicios</a></li>
        <li class="nav-item"><a class="nav-link link-navbar-clear active" href="index.html">Precios</a></li>
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle link-dropdown-clear" href="#" role="button" data-bs-toggle="dropdown">Mas</a>
            <ul class="dropdown-menu dropdown-menu-end">
              <li><a class="dropdown-item" href="../contacto/index.html">Contacto</a></li>
              <li><a class="dropdown-item" href="../nosotros/index.html">Nosotros</a></li>
              <li><a class="dropdown-item" href="../faq/index.html">FAQ</a></li>
            </ul>
        </li>
      </ul>
      <div class="d-flex gap-2 flex-wrap">
        <button class="btn-clearwater">Registrarse</button>
        <button class="btn-clearwater">Iniciar sesión</button>
      </div>
    </div>
  </div>
</nav>
</header>

<div style="height: 120px;"></div>

<main class="container my-5">
    <div class="titulo-con-lineas">
        <span class="linea"></span>
        <p class="fs-1 text-center titulo" style="color: var(--trescolor);">Calculadora de Productos</p>
        <span class="linea"></span>
    </div>

    <div class="row justify-content-center">
        <div class="col-lg-10">
            <p class="texto text-center mb-5 fs-5 text-secondary">
                Obtené el diagnóstico exacto para tu pileta. Indicá el estado del agua y calculá los litros para recibir el tratamiento preciso.
            </p>

            <div id="step1" class="wizard-step active">
                <h3 class="titulonav text-center mb-5">1. Seleccioná el estado actual del agua:</h3>
                <div class="row g-4 justify-content-center">
                    <div class="col-md-4">
                        <div class="card h-100 card-seleccion text-center p-4" onclick="selectColor('verde')">
                            <i class="fa-solid fa-biohazard icono-estado text-verde"></i>
                            <h4 class="titulo text-dark mt-3">Verde / Con Algas</h4>
                            <p class="texto text-secondary small">Agua oscura, verdosa, paredes resbaladizas.</p>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card h-100 card-seleccion text-center p-4" onclick="selectColor('turbia')">
                            <i class="fa-solid fa-water icono-estado text-turbia"></i>
                            <h4 class="titulo text-dark mt-3">Turbia / Blanca</h4>
                            <p class="texto text-secondary small">Agua lechosa o blanquecina, sin transparencia.</p>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card h-100 card-seleccion text-center p-4" onclick="selectColor('transparente')">
                            <i class="fa-solid fa-hand-sparkles icono-estado text-clara"></i>
                            <h4 class="titulo text-dark mt-3">Transparente</h4>
                            <p class="texto text-secondary small">Agua limpia, ideal para mantenimiento.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="step2" class="wizard-step">
                <h3 class="titulonav text-center mb-4">2. Ingresá la capacidad de tu pileta:</h3>
                
                <div class="row justify-content-center mb-4">
                    <div class="col-md-6">
                        <label class="form-label titulo text-center w-100">Si conocés los litros, ingresalos acá:</label>
                        <input type="number" class="form-control form-control-litros" id="inputLitros" placeholder="Ej: 40000">
                    </div>
                </div>

                <div class="text-center mb-4">
                    <span class="badge bg-secondary rounded-pill px-3 py-2 texto">O SI NO SABÉS, USÁ LA CALCULADORA ABAJO</span>
                </div>

                <div class="calculator-box mb-5">
                    <h5 class="titulo text-center mb-3" style="color: var(--trescolor);">Calculadora de Litros</h5>
                    
                    <div class="d-flex justify-content-center gap-2 mb-4">
                        <button class="btn shape-btn w-100" onclick="setShape('rectangular', this)">
                            <i class="fa-regular fa-square me-2"></i> Rectangular
                        </button>
                        <button class="btn shape-btn w-100" onclick="setShape('redonda', this)">
                            <i class="fa-regular fa-circle me-2"></i> Redonda
                        </button>
                        <button class="btn shape-btn w-100" onclick="setShape('ovalada', this)">
                            <i class="fa-solid fa-cloud me-2"></i> Ovalada
                        </button>
                    </div>

                    <div id="inputsDimensiones" class="row g-3 justify-content-center d-none">
                        </div>

                    <div id="btnCalcularDiv" class="text-center mt-3 d-none">
                        <button class="btn btn-dark btn-sm rounded-pill px-4" onclick="calcularLitrosPorForma()">
                            Calcular Volumen
                        </button>
                    </div>
                </div>

                <div class="d-flex flex-column flex-md-row gap-3 justify-content-center align-items-center">
                    <button class="btn btn-link text-secondary" onclick="showStep(1)">
                        <i class="fa-solid fa-arrow-left"></i> Volver
                    </button>
                    <button class="btn-servicio w-100 w-md-auto" onclick="finalizarCalculo()">
                        VER TRATAMIENTO
                    </button>
                </div>
            </div>

            <div id="step3" class="wizard-step">
                <div id="resultadoContent">
                    </div>
                 
                 <div class="mt-5 text-center d-flex flex-column flex-md-row gap-4 justify-content-center align-items-center">
                     <button class="btn btn-link text-secondary" onclick="location.reload()">
                        <i class="fa-solid fa-rotate-right"></i> Nuevo Cálculo
                    </button>
                    <a href="https://wa.me/5492914444431" target="_blank" class="btn-servicio">
                        Comprar Pack Completo
                    </a>
                </div>
            </div>

        </div>
    </div>
</main>

<footer class="bg-dark text-light pt-4 pb-3 mt-auto">
    <div class="container">
      <div class="row">
        <div class="col-md-4 mb-3 text-center text-md-start">
          <h5 class="titulo">Clear Water</h5>
          <p class="texto">Expertos en recuperación y mantenimiento de aguas.</p>
        </div>
        <div class="col-md-4 mb-3 text-center">
           <small class="text-muted">Desarrollo Web & Diseño</small>
        </div>
        <div class="col-md-4 mb-3 text-center text-md-end">
          <p class="texto">Contacto: +54 9 291 444-4431</p>
        </div>
      </div>
    </div> 
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
    let appState = { color: null, litros: 0, forma: null };

    // --- PROPORCIONES (Base: por cada 10.000 Litros) ---
    const RATIOS = {
        verde: {
            cloroShock: 200,   // 200g
            alguicida: 200,    // 200cc
            reguladorPh: 150   // Estimado
        },
        turbia: {
            clarificante: 50,  // 50cc
            cloroSolido: 100   // 100g
        },
        transparente: {
            pastillas: 1,      // 1 pastilla cada 20.000L
            alguicidaMant: 50, // 50cc semanal
            cloroMant: 20      // 20g diario
        }
    };

    // --- NAVEGACIÓN ---
    function showStep(n) {
        document.querySelectorAll('.wizard-step').forEach(s => s.classList.remove('active'));
        document.getElementById(`step${n}`).classList.add('active');
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function selectColor(c) {
        appState.color = c;
        document.querySelectorAll('.card-seleccion').forEach(el => el.classList.remove('active'));
        event.currentTarget.classList.add('active');
        setTimeout(() => showStep(2), 400);
    }

    // --- CALCULADORA DE FORMAS ---
    function setShape(shape, btn) {
        appState.forma = shape;
        document.querySelectorAll('.shape-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');

        const container = document.getElementById('inputsDimensiones');
        container.classList.remove('d-none');
        document.getElementById('btnCalcularDiv').classList.remove('d-none');
        
        let htmlInputs = '';
        if(shape === 'rectangular' || shape === 'ovalada') {
            htmlInputs = `
                <div class="col-4"><input type="number" id="dimLargo" class="form-control" placeholder="Largo (m)"></div>
                <div class="col-4"><input type="number" id="dimAncho" class="form-control" placeholder="Ancho (m)"></div>
                <div class="col-4"><input type="number" id="dimProf" class="form-control" placeholder="Prof. Media (m)"></div>
            `;
        } else if (shape === 'redonda') {
            htmlInputs = `
                <div class="col-6"><input type="number" id="dimDiametro" class="form-control" placeholder="Diámetro (m)"></div>
                <div class="col-6"><input type="number" id="dimProf" class="form-control" placeholder="Prof. Media (m)"></div>
            `;
        }
        container.innerHTML = htmlInputs;
    }

    function calcularLitrosPorForma() {
        let litros = 0;
        const prof = parseFloat(document.getElementById('dimProf')?.value || 0);

        if (appState.forma === 'rectangular') {
            const largo = parseFloat(document.getElementById('dimLargo').value);
            const ancho = parseFloat(document.getElementById('dimAncho').value);
            litros = largo * ancho * prof * 1000;
        } 
        else if (appState.forma === 'ovalada') {
            const largo = parseFloat(document.getElementById('dimLargo').value);
            const ancho = parseFloat(document.getElementById('dimAncho').value);
            litros = largo * ancho * prof * 890; 
        } 
        else if (appState.forma === 'redonda') {
            const diam = parseFloat(document.getElementById('dimDiametro').value);
            const radio = diam / 2;
            litros = Math.PI * (radio * radio) * prof * 1000;
        }

        if(litros > 0) {
            appState.litros = Math.round(litros);
            document.getElementById('inputLitros').value = appState.litros;
            const input = document.getElementById('inputLitros');
            input.style.backgroundColor = "#d1e7dd";
            setTimeout(() => input.style.backgroundColor = "white", 1000);
        } else {
            alert("Por favor, ingresá medidas válidas mayores a 0.");
        }
    }

    // --- GENERACIÓN DE RESULTADOS ---
    function finalizarCalculo() {
        const inputVal = document.getElementById('inputLitros').value;
        if(!inputVal || inputVal <= 0) {
            return alert("Por favor, ingresá la cantidad de litros o usá la calculadora.");
        }
        appState.litros = parseInt(inputVal);
        renderResultadoTexto();
    }

    function renderResultadoTexto() {
        const L = appState.litros;
        const factor = L / 10000;
        let html = '';

        // Definimos la estructura HTML
        if (appState.color === 'verde') {
            const qCloro = Math.round(RATIOS.verde.cloroShock * factor);
            const qAlguicida = Math.round(RATIOS.verde.alguicida * factor);
            
            html = `
                <div class="resultado-box">
                    <h2 class="titulo mb-3" style="color: var(--trescolor);">TRATAMIENTO DE SHOCK</h2>
                    <div class="alert alert-calculo mb-4">
                        <h4 class="titulonav mb-0"><i class="fa-solid fa-calculator me-2"></i> CÁLCULO PARA ${L.toLocaleString('es-AR')} LITROS</h4>
                    </div>
                    
                    <div class="box-productos mb-5">
                        <h4 class="titulonav mb-3"><i class="fa-solid fa-cart-shopping me-2"></i> LISTA DE COMPRAS:</h4>
                        <ul class="list-unstyled mb-0 texto">
                            <li><i class="fa-solid fa-check me-2"></i> <strong>${qAlguicida} cc</strong> de Alguicida de Choque</li>
                            <li><i class="fa-solid fa-check me-2"></i> <strong>${qCloro} gr</strong> de Cloro Shock Granulado</li>
                            <li><i class="fa-solid fa-check me-2"></i> <strong>1</strong> Regulador de pH (Mas o Menos)</li>
                        </ul>
                    </div>
                    
                    <p class="texto mb-4">Para recuperar el agua verde de tu pileta, es fundamental seguir este procedimiento de impacto. Asegurate de que el sistema de filtrado funcione correctamente antes de iniciar.</p>

                    <h4 class="titulonav text-dark border-bottom pb-2 mb-3">PASO A PASO DETALLADO:</h4>
                    <ul class="list-unstyled texto text-dark" style="font-size: 1.1rem; line-height: 1.8;">
                        <li class="mb-3">
                            <strong>1. Regulá el pH:</strong> Verificá que el pH se encuentre entre 7.2 y 7.4. Si está desajustado, los productos no actuarán con eficacia.
                        </li>
                        <li class="mb-3">
                            <strong>2. Aplicá el Alguicida:</strong> Incorporá la dosis calculada de Alguicida de Choque diluido previamente en un balde con agua, distribuyéndolo por todo el contorno de la pileta.
                        </li>
                        <li class="mb-3">
                            <strong>3. Agregá el Cloro Potente:</strong> Esperá una hora y luego agregá el Cloro Shock Granulado. Esparcilo uniformemente sobre la superficie.
                        </li>
                        <li class="mb-3">
                            <strong>4. Recirculación y Reposo:</strong> Poné el filtro en modo "Recircular" durante 4 horas para mezclar bien los químicos. Luego, apagá la bomba y dejá reposar toda la noche (mínimo 12 horas) para que las algas muertas decanten al fondo.
                        </li>
                        <li class="mb-3">
                            <strong>5. Limpieza final:</strong> Pasá el barrefondo muy lentamente con la válvula en posición <strong>"DRENAJE" o "DESAGOTE"</strong> (no en filtrado), tirando el agua sucia fuera de la pileta.
                        </li>
                    </ul>
                </div>
            `;
        } 
        else if (appState.color === 'turbia') {
            const qClarificante = Math.round(RATIOS.turbia.clarificante * factor);
            const qCloro = Math.round(RATIOS.turbia.cloroSolido * factor);

            html = `
                <div class="resultado-box">
                    <h2 class="titulo mb-3" style="color: var(--trescolor);">TRATAMIENTO DE CLARIFICACIÓN</h2>
                    <div class="alert alert-calculo mb-4">
                        <h4 class="titulonav mb-0"><i class="fa-solid fa-calculator me-2"></i> CÁLCULO PARA ${L.toLocaleString('es-AR')} LITROS</h4>
                    </div>

                    <div class="box-productos mb-5">
                        <h4 class="titulonav mb-3"><i class="fa-solid fa-cart-shopping me-2"></i> LISTA DE COMPRAS:</h4>
                        <ul class="list-unstyled mb-0 texto">
                            <li><i class="fa-solid fa-check me-2"></i> <strong>${qClarificante} cc</strong> de Clarificante/Floculante</li>
                            <li><i class="fa-solid fa-check me-2"></i> <strong>${qCloro} gr</strong> de Cloro Sólido</li>
                            <li><i class="fa-solid fa-check me-2"></i> <strong>1</strong> Kit de Medición pH/Cloro</li>
                        </ul>
                    </div>

                    <p class="texto mb-4">Si el agua se ve lechosa o turbia, significa que hay partículas finas en suspensión. Procedé con este tratamiento de floculación.</p>

                    <h4 class="titulonav text-dark border-bottom pb-2 mb-3">PROCEDIMIENTO DETALLADO:</h4>
                    <ul class="list-unstyled texto text-dark" style="font-size: 1.1rem; line-height: 1.8;">
                        <li class="mb-3">
                            <strong>1. Control de pH:</strong> Medí el pH y ajustalo si es necesario. El clarificante funciona mejor con un pH neutro (7.2 - 7.6).
                        </li>
                        <li class="mb-3">
                            <strong>2. Refuerzo de Cloro:</strong> Adicioná el Cloro Sólido para desinfectar cualquier bacteria presente.
                        </li>
                        <li class="mb-3">
                            <strong>3. Aplicación del Clarificante:</strong> Agregá la dosis de Clarificante. Hacelo con el filtro en funcionamiento (Recirculación) para que se mezcle bien.
                        </li>
                        <li class="mb-3">
                            <strong>4. Decantación:</strong> Dejá recirculando 1 hora y luego apagá el equipo. Es vital dejar el agua totalmente quieta durante al menos 8 horas para que la suciedad baje al piso.
                        </li>
                        <li class="mb-3">
                            <strong>5. Aspirado:</strong> Pasá el limpiafondos con movimientos muy suaves para no levantar la "nube" de suciedad del fondo. Hacelo desechando el agua (posición Desagote).
                        </li>
                    </ul>
                </div>
            `;
        }
        else if (appState.color === 'transparente') {
            const qPastillas = Math.ceil(L / 20000); 
            const qAlguicida = Math.round(RATIOS.transparente.alguicidaMant * factor);
            const qCloroMant = Math.round(RATIOS.transparente.cloroMant * factor * 7);

            html = `
                <div class="resultado-box">
                    <h2 class="titulo mb-3" style="color: var(--trescolor);">MANTENIMIENTO PREVENTIVO</h2>
                    <div class="alert alert-calculo mb-4">
                        <h4 class="titulonav mb-0"><i class="fa-solid fa-calculator me-2"></i> RUTINA PARA ${L.toLocaleString('es-AR')} LITROS</h4>
                    </div>

                    <div class="box-productos mb-5">
                        <h4 class="titulonav mb-3"><i class="fa-solid fa-cart-shopping me-2"></i> TU STOCK RECOMENDADO:</h4>
                        <ul class="list-unstyled mb-0 texto">
                            <li><i class="fa-solid fa-check me-2"></i> <strong>${qPastillas} u.</strong> Pastillas Triple Acción (Reposición)</li>
                            <li><i class="fa-solid fa-check me-2"></i> <strong>${qAlguicida} cc</strong> Alguicida de Mantenimiento (Semanal)</li>
                            <li><i class="fa-solid fa-check me-2"></i> <strong>${qCloroMant} gr</strong> Cloro Granulado (Refuerzo Semanal)</li>
                        </ul>
                    </div>

                    <p class="texto mb-4">¡Excelente! Tu agua está en condiciones. Para mantenerla cristalina y sana, seguí esta rutina semanal obligatoria.</p>

                    <h4 class="titulonav text-dark border-bottom pb-2 mb-3">RUTINA SEMANAL DETALLADA:</h4>
                    <ul class="list-unstyled texto text-dark" style="font-size: 1.1rem; line-height: 1.8;">
                        <li class="mb-3">
                            <strong><i class="fa-solid fa-calendar-check text-primary"></i> Filtrado Diario:</strong> En verano, filtrá el agua al menos 6 a 8 horas diarias, preferentemente en dos tandas.
                        </li>
                        <li class="mb-3">
                            <strong><i class="fa-solid fa-capsules text-primary"></i> Pastillas Triple Acción:</strong> Colocá las pastillas calculadas en la boya o en el skimmer. Reponelas apenas se consuman.
                        </li>
                        <li class="mb-3">
                            <strong><i class="fa-solid fa-flask text-primary"></i> Refuerzo Semanal:</strong> Una vez por semana, agregá el Alguicida de Mantenimiento y el Cloro de refuerzo para prevenir la formación de hongos y algas.
                        </li>
                        <li class="mb-3">
                            <strong><i class="fa-solid fa-vial text-primary"></i> Control Químico:</strong> Chequeá los niveles de cloro y pH al menos una vez por semana utilizando tu kit de medición.
                        </li>
                    </ul>
                </div>
            `;
        }

        document.getElementById('resultadoContent').innerHTML = html;
        showStep(3);
    }
</script>

</body>
</html>